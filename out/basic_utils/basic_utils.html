<!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>Basic Utils &#x57fa;&#x7840;&#x5de5;&#x5177;&#x6a21;&#x5757;</title>
            <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only],
.vscode-high-contrast:not(.vscode-high-contrast-light) img[src$=\#gh-light-mode-only],
.vscode-high-contrast-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

</style>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item {
    list-style-type: none;
}

.task-list-item-checkbox {
    margin-left: -20px;
    vertical-align: middle;
    pointer-events: none;
}
</style>
<style>
:root {
  --color-note: #0969da;
  --color-tip: #1a7f37;
  --color-warning: #9a6700;
  --color-severe: #bc4c00;
  --color-caution: #d1242f;
  --color-important: #8250df;
}

</style>
<style>
@media (prefers-color-scheme: dark) {
  :root {
    --color-note: #2f81f7;
    --color-tip: #3fb950;
    --color-warning: #d29922;
    --color-severe: #db6d28;
    --color-caution: #f85149;
    --color-important: #a371f7;
  }
}

</style>
<style>
.markdown-alert {
  padding: 0.5rem 1rem;
  margin-bottom: 16px;
  color: inherit;
  border-left: .25em solid #888;
}

.markdown-alert>:first-child {
  margin-top: 0
}

.markdown-alert>:last-child {
  margin-bottom: 0
}

.markdown-alert .markdown-alert-title {
  display: flex;
  font-weight: 500;
  align-items: center;
  line-height: 1
}

.markdown-alert .markdown-alert-title .octicon {
  margin-right: 0.5rem;
  display: inline-block;
  overflow: visible !important;
  vertical-align: text-bottom;
  fill: currentColor;
}

.markdown-alert.markdown-alert-note {
  border-left-color: var(--color-note);
}

.markdown-alert.markdown-alert-note .markdown-alert-title {
  color: var(--color-note);
}

.markdown-alert.markdown-alert-important {
  border-left-color: var(--color-important);
}

.markdown-alert.markdown-alert-important .markdown-alert-title {
  color: var(--color-important);
}

.markdown-alert.markdown-alert-warning {
  border-left-color: var(--color-warning);
}

.markdown-alert.markdown-alert-warning .markdown-alert-title {
  color: var(--color-warning);
}

.markdown-alert.markdown-alert-tip {
  border-left-color: var(--color-tip);
}

.markdown-alert.markdown-alert-tip .markdown-alert-title {
  color: var(--color-tip);
}

.markdown-alert.markdown-alert-caution {
  border-left-color: var(--color-caution);
}

.markdown-alert.markdown-alert-caution .markdown-alert-title {
  color: var(--color-caution);
}

</style>
        
        </head>
        <body class="vscode-body vscode-light">
            <h1 id="basic-utils-基础工具模块">Basic Utils 基础工具模块</h1>
<h2 id="模块概述">模块概述</h2>
<p><code>basic_utils</code> 是 OneApp 基础工具模块群中的核心工具集合，提供了应用开发中常用的基础工具类、辅助方法和通用组件。该模块包含了事件总线、图片处理、分享功能、加密解密、文件上传等丰富的工具功能。</p>
<h3 id="基本信息">基本信息</h3>
<ul>
<li><strong>模块名称</strong>: basic_utils</li>
<li><strong>版本</strong>: 0.0.3</li>
<li><strong>描述</strong>: 基础工具包</li>
<li><strong>Flutter 版本</strong>: &gt;=2.10.5</li>
<li><strong>Dart 版本</strong>: &gt;=3.0.0 &lt;4.0.08</li>
</ul>
<h2 id="功能特性">功能特性</h2>
<h3 id="核心功能">核心功能</h3>
<ol>
<li>
<p><strong>事件总线系统</strong></p>
<ul>
<li>全局事件发布订阅</li>
<li>类型安全的事件传递</li>
<li>事件生命周期管理</li>
<li>异步事件处理</li>
</ul>
</li>
<li>
<p><strong>图片处理工具</strong></p>
<ul>
<li>图片选择和拍照</li>
<li>图片压缩和格式转换</li>
<li>图片裁剪和编辑</li>
<li>图片缓存管理</li>
</ul>
</li>
<li>
<p><strong>分享功能集成</strong></p>
<ul>
<li>社交平台分享</li>
<li>文件分享</li>
<li>链接分享</li>
<li>自定义分享内容</li>
</ul>
</li>
<li>
<p><strong>加密解密服务</strong></p>
<ul>
<li>对称加密算法</li>
<li>非对称加密算法</li>
<li>哈希算法</li>
<li>数字签名</li>
</ul>
</li>
<li>
<p><strong>云存储服务</strong></p>
<ul>
<li>腾讯云COS集成</li>
<li>文件上传下载</li>
<li>断点续传</li>
<li>存储管理</li>
</ul>
</li>
</ol>
<h2 id="技术架构">技术架构</h2>
<h3 id="目录结构">目录结构</h3>
<pre><code>lib/
├── basic_utils.dart            # 模块入口文件
├── src/                        # 源代码目录
│   ├── event_bus/              # 事件总线
│   ├── image/                  # 图片处理
│   ├── share/                  # 分享功能
│   ├── crypto/                 # 加密解密
│   ├── storage/                # 云存储
│   ├── network/                # 网络工具
│   ├── utils/                  # 通用工具
│   └── models/                 # 数据模型
├── widgets/                    # 通用组件
└── test/                       # 测试文件
</code></pre>
<h3 id="依赖关系">依赖关系</h3>
<h4 id="核心框架依赖">核心框架依赖</h4>
<ul>
<li><code>basic_modular: ^0.2.3</code> - 模块化框架</li>
<li><code>basic_storage: 0.2.2</code> - 基础存储</li>
<li><code>basic_webview: ^0.2.4</code> - WebView组件</li>
</ul>
<h4 id="工具依赖">工具依赖</h4>
<ul>
<li><code>event_bus: ^2.0.0</code> - 事件总线</li>
<li><code>shared_preferences: ^2.0.17</code> - 本地存储</li>
<li><code>http: ^1.0.0</code> - HTTP客户端</li>
<li><code>dartz: ^0.10.1</code> - 函数式编程</li>
</ul>
<h4 id="功能依赖">功能依赖</h4>
<ul>
<li><code>image_picker: ^1.1.2</code> - 图片选择</li>
<li><code>flutter_image_compress: 2.1.0</code> - 图片压缩</li>
<li><code>share_plus: 7.2.1</code> - 分享功能</li>
<li><code>fluwx: ^4.2.5</code> - 微信SDK</li>
<li><code>weibo_kit: ^4.0.0</code> - 微博SDK</li>
</ul>
<h4 id="安全依赖">安全依赖</h4>
<ul>
<li><code>crypto: any</code> - 加密算法</li>
<li><code>encrypt: any</code> - 加密工具</li>
<li><code>pointycastle: any</code> - 加密库</li>
</ul>
<h4 id="云服务依赖">云服务依赖</h4>
<ul>
<li><code>tencentcloud_cos_sdk_plugin: 1.2.0</code> - 腾讯云COS</li>
</ul>
<h2 id="核心模块分析">核心模块分析</h2>
<h3 id="1-模块入口-basic_utilsdart">1. 模块入口 (<code>basic_utils.dart</code>)</h3>
<p><strong>功能职责</strong>:</p>
<ul>
<li>工具模块统一导出</li>
<li>全局配置初始化</li>
<li>服务注册管理</li>
</ul>
<h3 id="2-事件总线-srcevent_bus">2. 事件总线 (<code>src/event_bus/</code>)</h3>
<p><strong>功能职责</strong>:</p>
<ul>
<li>全局事件发布订阅机制</li>
<li>类型安全的事件传递</li>
<li>事件过滤和转换</li>
<li>内存泄漏防护</li>
</ul>
<p><strong>主要组件</strong>:</p>
<ul>
<li><code>GlobalEventBus</code> - 全局事件总线</li>
<li><code>EventSubscription</code> - 事件订阅管理</li>
<li><code>TypedEvent</code> - 类型化事件</li>
<li><code>EventFilter</code> - 事件过滤器</li>
</ul>
<p><strong>使用示例</strong>:</p>
<pre><code class="language-dart"><span class="hljs-comment">// 定义事件类型</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserLoginEvent</span> </span>{
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> userId;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> userName;
  
  UserLoginEvent(<span class="hljs-keyword">this</span>.userId, <span class="hljs-keyword">this</span>.userName);
}

<span class="hljs-comment">// 发布事件</span>
GlobalEventBus.instance.fire(UserLoginEvent(<span class="hljs-string">&#x27;123&#x27;</span>, <span class="hljs-string">&#x27;John&#x27;</span>));

<span class="hljs-comment">// 订阅事件</span>
<span class="hljs-keyword">final</span> subscription = GlobalEventBus.instance.<span class="hljs-keyword">on</span>&lt;UserLoginEvent&gt;().listen((event) {
  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;User <span class="hljs-subst">${event.userName}</span> logged in&#x27;</span>);
});

<span class="hljs-comment">// 取消订阅</span>
subscription.cancel();
</code></pre>
<h3 id="3-图片处理-srcimage">3. 图片处理 (<code>src/image/</code>)</h3>
<p><strong>功能职责</strong>:</p>
<ul>
<li>图片选择和拍照功能</li>
<li>图片压缩和格式转换</li>
<li>图片编辑和处理</li>
<li>图片缓存和管理</li>
</ul>
<p><strong>主要组件</strong>:</p>
<ul>
<li><code>ImagePicker</code> - 图片选择器</li>
<li><code>ImageCompressor</code> - 图片压缩器</li>
<li><code>ImageEditor</code> - 图片编辑器</li>
<li><code>ImageCache</code> - 图片缓存管理</li>
</ul>
<p><strong>使用示例</strong>:</p>
<pre><code class="language-dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ImageUtils</span> </span>{
  <span class="hljs-keyword">static</span> Future&lt;File?&gt; pickImage({
    ImageSource source = ImageSource.gallery,
    <span class="hljs-built_in">double?</span> maxWidth,
    <span class="hljs-built_in">double?</span> maxHeight,
    <span class="hljs-built_in">int?</span> imageQuality,
  }) <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">final</span> picker = ImagePicker();
    <span class="hljs-keyword">final</span> XFile? image = <span class="hljs-keyword">await</span> picker.pickImage(
      source: source,
      maxWidth: maxWidth,
      maxHeight: maxHeight,
      imageQuality: imageQuality,
    );
    
    <span class="hljs-keyword">return</span> image != <span class="hljs-keyword">null</span> ? File(image.path) : <span class="hljs-keyword">null</span>;
  }
  
  <span class="hljs-keyword">static</span> Future&lt;File&gt; compressImage(
    File file, {
    <span class="hljs-built_in">int</span> quality = <span class="hljs-number">85</span>,
    <span class="hljs-built_in">int?</span> minWidth,
    <span class="hljs-built_in">int?</span> minHeight,
  }) <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">final</span> result = <span class="hljs-keyword">await</span> FlutterImageCompress.compressAndGetFile(
      file.absolute.path,
      <span class="hljs-string">&#x27;<span class="hljs-subst">${file.parent.path}</span>/compressed_<span class="hljs-subst">${file.name}</span>&#x27;</span>,
      quality: quality,
      minWidth: minWidth,
      minHeight: minHeight,
    );
    
    <span class="hljs-keyword">return</span> File(result!.path);
  }
}
</code></pre>
<h3 id="4-分享功能-srcshare">4. 分享功能 (<code>src/share/</code>)</h3>
<p><strong>功能职责</strong>:</p>
<ul>
<li>系统原生分享</li>
<li>社交平台分享</li>
<li>自定义分享内容</li>
<li>分享结果回调</li>
</ul>
<p><strong>主要组件</strong>:</p>
<ul>
<li><code>ShareManager</code> - 分享管理器</li>
<li><code>WeChatShare</code> - 微信分享</li>
<li><code>WeiboShare</code> - 微博分享</li>
<li><code>SystemShare</code> - 系统分享</li>
</ul>
<p><strong>使用示例</strong>:</p>
<pre><code class="language-dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ShareUtils</span> </span>{
  <span class="hljs-keyword">static</span> Future&lt;<span class="hljs-keyword">void</span>&gt; shareText(<span class="hljs-built_in">String</span> text) <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">await</span> Share.share(text);
  }
  
  <span class="hljs-keyword">static</span> Future&lt;<span class="hljs-keyword">void</span>&gt; shareFile(<span class="hljs-built_in">String</span> filePath) <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">await</span> Share.shareXFiles([XFile(filePath)]);
  }
  
  <span class="hljs-keyword">static</span> Future&lt;<span class="hljs-keyword">void</span>&gt; shareToWeChat({
    <span class="hljs-keyword">required</span> <span class="hljs-built_in">String</span> title,
    <span class="hljs-keyword">required</span> <span class="hljs-built_in">String</span> description,
    <span class="hljs-built_in">String?</span> imageUrl,
    <span class="hljs-built_in">String?</span> webpageUrl,
  }) <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">final</span> model = WeChatShareWebPageModel(
      webPage: webpageUrl ?? <span class="hljs-string">&#x27;&#x27;</span>,
      title: title,
      description: description,
      thumbnail: WeChatImage.network(imageUrl ?? <span class="hljs-string">&#x27;&#x27;</span>),
    );
    
    <span class="hljs-keyword">await</span> fluwx.shareToWeChat(model);
  }
}
</code></pre>
<h3 id="5-加密解密-srccrypto">5. 加密解密 (<code>src/crypto/</code>)</h3>
<p><strong>功能职责</strong>:</p>
<ul>
<li>对称加密解密</li>
<li>非对称加密解密</li>
<li>数字签名验证</li>
<li>哈希算法实现</li>
</ul>
<p><strong>主要组件</strong>:</p>
<ul>
<li><code>AESCrypto</code> - AES加密</li>
<li><code>RSACrypto</code> - RSA加密</li>
<li><code>HashUtils</code> - 哈希工具</li>
<li><code>SignatureUtils</code> - 数字签名</li>
</ul>
<p><strong>使用示例</strong>:</p>
<pre><code class="language-dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CryptoUtils</span> </span>{
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">String</span> md5Hash(<span class="hljs-built_in">String</span> input) {
    <span class="hljs-keyword">final</span> bytes = utf8.encode(input);
    <span class="hljs-keyword">final</span> digest = md5.convert(bytes);
    <span class="hljs-keyword">return</span> digest.toString();
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">String</span> sha256Hash(<span class="hljs-built_in">String</span> input) {
    <span class="hljs-keyword">final</span> bytes = utf8.encode(input);
    <span class="hljs-keyword">final</span> digest = sha256.convert(bytes);
    <span class="hljs-keyword">return</span> digest.toString();
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">String</span> aesEncrypt(<span class="hljs-built_in">String</span> plainText, <span class="hljs-built_in">String</span> key) {
    <span class="hljs-keyword">final</span> encrypter = Encrypter(AES(Key.fromBase64(key)));
    <span class="hljs-keyword">final</span> encrypted = encrypter.encrypt(plainText);
    <span class="hljs-keyword">return</span> encrypted.base64;
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">String</span> aesDecrypt(<span class="hljs-built_in">String</span> encryptedText, <span class="hljs-built_in">String</span> key) {
    <span class="hljs-keyword">final</span> encrypter = Encrypter(AES(Key.fromBase64(key)));
    <span class="hljs-keyword">final</span> decrypted = encrypter.decrypt64(encryptedText);
    <span class="hljs-keyword">return</span> decrypted;
  }
}
</code></pre>
<h3 id="6-云存储-srcstorage">6. 云存储 (<code>src/storage/</code>)</h3>
<p><strong>功能职责</strong>:</p>
<ul>
<li>腾讯云COS集成</li>
<li>文件上传下载</li>
<li>断点续传</li>
<li>存储空间管理</li>
</ul>
<p><strong>主要组件</strong>:</p>
<ul>
<li><code>COSManager</code> - COS管理器</li>
<li><code>FileUploader</code> - 文件上传器</li>
<li><code>FileDownloader</code> - 文件下载器</li>
<li><code>StorageMonitor</code> - 存储监控</li>
</ul>
<p><strong>使用示例</strong>:</p>
<pre><code class="language-dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CloudStorageUtils</span> </span>{
  <span class="hljs-keyword">static</span> Future&lt;<span class="hljs-built_in">String?</span>&gt; uploadFile(
    <span class="hljs-built_in">String</span> filePath, {
    <span class="hljs-built_in">String?</span> objectKey,
    <span class="hljs-built_in">Function</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">int</span>)? onProgress,
  }) <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">final</span> result = <span class="hljs-keyword">await</span> TencentCloudCosSdkPlugin.upload(
        filePath,
        objectKey ?? _generateObjectKey(filePath),
        onProgress: onProgress,
      );
      
      <span class="hljs-keyword">return</span> result[<span class="hljs-string">&#x27;url&#x27;</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">String?</span>;
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Upload failed: <span class="hljs-subst">$e</span>&#x27;</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    }
  }
  
  <span class="hljs-keyword">static</span> Future&lt;<span class="hljs-built_in">bool</span>&gt; downloadFile(
    <span class="hljs-built_in">String</span> url,
    <span class="hljs-built_in">String</span> savePath, {
    <span class="hljs-built_in">Function</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">int</span>)? onProgress,
  }) <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> TencentCloudCosSdkPlugin.download(
        url,
        savePath,
        onProgress: onProgress,
      );
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Download failed: <span class="hljs-subst">$e</span>&#x27;</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">String</span> _generateObjectKey(<span class="hljs-built_in">String</span> filePath) {
    <span class="hljs-keyword">final</span> fileName = path.basename(filePath);
    <span class="hljs-keyword">final</span> timestamp = <span class="hljs-built_in">DateTime</span>.now().millisecondsSinceEpoch;
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;uploads/<span class="hljs-subst">$timestamp</span>/<span class="hljs-subst">$fileName</span>&#x27;</span>;
  }
}
</code></pre>
<h3 id="7-网络工具-srcnetwork">7. 网络工具 (<code>src/network/</code>)</h3>
<p><strong>功能职责</strong>:</p>
<ul>
<li>HTTP请求封装</li>
<li>网络状态检测</li>
<li>请求重试机制</li>
<li>响应数据处理</li>
</ul>
<p><strong>主要组件</strong>:</p>
<ul>
<li><code>HttpClient</code> - HTTP客户端</li>
<li><code>NetworkMonitor</code> - 网络监控</li>
<li><code>RequestInterceptor</code> - 请求拦截器</li>
<li><code>ResponseHandler</code> - 响应处理器</li>
</ul>
<h3 id="8-通用工具-srcutils">8. 通用工具 (<code>src/utils/</code>)</h3>
<p><strong>功能职责</strong>:</p>
<ul>
<li>字符串处理工具</li>
<li>日期时间工具</li>
<li>数学计算工具</li>
<li>格式化工具</li>
</ul>
<p><strong>主要工具</strong>:</p>
<ul>
<li><code>StringUtils</code> - 字符串工具</li>
<li><code>DateUtils</code> - 日期工具</li>
<li><code>MathUtils</code> - 数学工具</li>
<li><code>FormatUtils</code> - 格式化工具</li>
</ul>
<p><strong>工具方法示例</strong>:</p>
<pre><code class="language-dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StringUtils</span> </span>{
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> isNullOrEmpty(<span class="hljs-built_in">String?</span> str) {
    <span class="hljs-keyword">return</span> str == <span class="hljs-keyword">null</span> || str.isEmpty;
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> isValidEmail(<span class="hljs-built_in">String</span> email) {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">r&#x27;^[^@]+@[^@]+\.[^@]+&#x27;</span>).hasMatch(email);
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> isValidPhone(<span class="hljs-built_in">String</span> phone) {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">r&#x27;^1[3-9]\d{9}$&#x27;</span>).hasMatch(phone);
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">String</span> maskPhone(<span class="hljs-built_in">String</span> phone) {
    <span class="hljs-keyword">if</span> (phone.length != <span class="hljs-number">11</span>) <span class="hljs-keyword">return</span> phone;
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;<span class="hljs-subst">${phone.substring(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>)}</span>****<span class="hljs-subst">${phone.substring(<span class="hljs-number">7</span>)}</span>&#x27;</span>;
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DateUtils</span> </span>{
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">String</span> formatDateTime(<span class="hljs-built_in">DateTime</span> dateTime, [<span class="hljs-built_in">String?</span> pattern]) {
    pattern ??= <span class="hljs-string">&#x27;yyyy-MM-dd HH:mm:ss&#x27;</span>;
    <span class="hljs-keyword">return</span> DateFormat(pattern).format(dateTime);
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">DateTime?</span> parseDateTime(<span class="hljs-built_in">String</span> dateStr, [<span class="hljs-built_in">String?</span> pattern]) {
    <span class="hljs-keyword">try</span> {
      pattern ??= <span class="hljs-string">&#x27;yyyy-MM-dd HH:mm:ss&#x27;</span>;
      <span class="hljs-keyword">return</span> DateFormat(pattern).parse(dateStr);
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    }
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> isToday(<span class="hljs-built_in">DateTime</span> dateTime) {
    <span class="hljs-keyword">final</span> now = <span class="hljs-built_in">DateTime</span>.now();
    <span class="hljs-keyword">return</span> dateTime.year == now.year &amp;&amp;
           dateTime.month == now.month &amp;&amp;
           dateTime.day == now.day;
  }
}
</code></pre>
<h2 id="通用组件">通用组件</h2>
<h3 id="loading组件">Loading组件</h3>
<pre><code class="language-dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoadingUtils</span> </span>{
  <span class="hljs-keyword">static</span> OverlayEntry? _overlayEntry;
  
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-keyword">show</span>(BuildContext context, {<span class="hljs-built_in">String?</span> message}) {
    <span class="hljs-keyword">hide</span>(); <span class="hljs-comment">// 先隐藏之前的</span>
    
    _overlayEntry = OverlayEntry(
      builder: (context) =&gt; Material(
        color: Colors.black54,
        child: Center(
          child: Container(
            padding: <span class="hljs-keyword">const</span> EdgeInsets.all(<span class="hljs-number">20</span>),
            decoration: BoxDecoration(
              color: Colors.white,
              borderRadius: BorderRadius.circular(<span class="hljs-number">8</span>),
            ),
            child: Column(
              mainAxisSize: MainAxisSize.min,
              children: [
                <span class="hljs-keyword">const</span> CircularProgressIndicator(),
                <span class="hljs-keyword">if</span> (message != <span class="hljs-keyword">null</span>) ...[
                  <span class="hljs-keyword">const</span> SizedBox(height: <span class="hljs-number">16</span>),
                  Text(message),
                ],
              ],
            ),
          ),
        ),
      ),
    );
    
    Overlay.of(context).insert(_overlayEntry!);
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-keyword">hide</span>() {
    _overlayEntry?.remove();
    _overlayEntry = <span class="hljs-keyword">null</span>;
  }
}
</code></pre>
<h3 id="toast组件">Toast组件</h3>
<pre><code class="language-dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ToastUtils</span> </span>{
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> showSuccess(<span class="hljs-built_in">String</span> message) {
    Fluttertoast.showToast(
      msg: message,
      backgroundColor: Colors.green,
      textColor: Colors.white,
      toastLength: Toast.LENGTH_SHORT,
    );
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> showError(<span class="hljs-built_in">String</span> message) {
    Fluttertoast.showToast(
      msg: message,
      backgroundColor: Colors.red,
      textColor: Colors.white,
      toastLength: Toast.LENGTH_SHORT,
    );
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> showInfo(<span class="hljs-built_in">String</span> message) {
    Fluttertoast.showToast(
      msg: message,
      backgroundColor: Colors.blue,
      textColor: Colors.white,
      toastLength: Toast.LENGTH_SHORT,
    );
  }
}
</code></pre>
<h2 id="性能优化">性能优化</h2>
<h3 id="内存管理">内存管理</h3>
<ul>
<li><strong>事件订阅管理</strong>: 及时取消不需要的事件订阅</li>
<li><strong>图片内存优化</strong>: 合理控制图片加载和缓存</li>
<li><strong>对象池</strong>: 复用常用对象减少GC压力</li>
<li><strong>弱引用</strong>: 使用弱引用避免内存泄漏</li>
</ul>
<h3 id="网络优化">网络优化</h3>
<ul>
<li><strong>请求缓存</strong>: 缓存网络请求结果</li>
<li><strong>并发控制</strong>: 控制并发请求数量</li>
<li><strong>超时重试</strong>: 智能超时和重试机制</li>
<li><strong>数据压缩</strong>: 压缩传输数据</li>
</ul>
<h3 id="存储优化">存储优化</h3>
<ul>
<li><strong>文件压缩</strong>: 压缩存储文件</li>
<li><strong>清理策略</strong>: 定期清理过期文件</li>
<li><strong>分块上传</strong>: 大文件分块上传</li>
<li><strong>断点续传</strong>: 支持上传下载断点续传</li>
</ul>
<h2 id="安全特性">安全特性</h2>
<h3 id="数据安全">数据安全</h3>
<ul>
<li><strong>敏感数据加密</strong>: 敏感信息加密存储</li>
<li><strong>传输加密</strong>: HTTPS传输保护</li>
<li><strong>数据校验</strong>: 数据完整性校验</li>
<li><strong>防篡改</strong>: 数字签名防篡改</li>
</ul>
<h3 id="隐私保护">隐私保护</h3>
<ul>
<li><strong>权限控制</strong>: 严格的功能权限控制</li>
<li><strong>数据脱敏</strong>: 敏感数据脱敏处理</li>
<li><strong>本地存储</strong>: 安全的本地数据存储</li>
<li><strong>清理机制</strong>: 数据清理和销毁机制</li>
</ul>
<h2 id="测试策略">测试策略</h2>
<h3 id="单元测试">单元测试</h3>
<ul>
<li><strong>工具类测试</strong>: 各种工具方法测试</li>
<li><strong>加密解密测试</strong>: 加密算法正确性</li>
<li><strong>事件总线测试</strong>: 事件发布订阅机制</li>
<li><strong>网络工具测试</strong>: 网络请求功能</li>
</ul>
<h3 id="集成测试">集成测试</h3>
<ul>
<li><strong>文件上传测试</strong>: 云存储集成测试</li>
<li><strong>分享功能测试</strong>: 社交分享集成测试</li>
<li><strong>图片处理测试</strong>: 图片处理流程测试</li>
<li><strong>端到端测试</strong>: 完整功能流程测试</li>
</ul>
<h3 id="性能测试">性能测试</h3>
<ul>
<li><strong>内存泄漏测试</strong>: 长时间运行检测</li>
<li><strong>并发性能测试</strong>: 高并发场景测试</li>
<li><strong>文件处理测试</strong>: 大文件处理性能</li>
<li><strong>网络性能测试</strong>: 网络请求性能</li>
</ul>
<h2 id="最佳实践">最佳实践</h2>
<h3 id="开发建议">开发建议</h3>
<ol>
<li><strong>工具复用</strong>: 优先使用现有工具方法</li>
<li><strong>异常处理</strong>: 完善的异常处理机制</li>
<li><strong>资源管理</strong>: 及时释放不需要的资源</li>
<li><strong>性能考虑</strong>: 避免不必要的操作开销</li>
</ol>
<h3 id="使用指南">使用指南</h3>
<ol>
<li><strong>按需导入</strong>: 只导入需要的工具类</li>
<li><strong>配置优化</strong>: 合理配置各种参数</li>
<li><strong>错误处理</strong>: 妥善处理可能的错误</li>
<li><strong>日志记录</strong>: 记录关键操作日志</li>
</ol>
<h2 id="总结">总结</h2>
<p><code>basic_utils</code> 模块作为 OneApp 的基础工具集合，提供了丰富的开发工具和辅助功能。通过事件总线、图片处理、分享功能、加密解密等核心能力，大大简化了应用开发的复杂性。模块具有良好的性能优化和安全保护机制，能够满足各种开发场景的需求。</p>

            <script async src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
            
        </body>
        </html>